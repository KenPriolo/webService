import{w as D}from"./with-props-DbFBUsUC.js";import{r as l,l as e}from"./chunk-K6CSEXPM-DdwNiGzb.js";import{i as S,b as j,o as U,d as C,u as L}from"./firebaseConfig-BRVrc43n.js";import"./index-e84cf44d-CdAT_r-a.js";const y=n=>n?typeof n=="string"?n:n.seconds?new Date(n.seconds*1e3).toLocaleDateString():"Invalid date":"N/A",E=()=>{const[n,d]=l.useState([]),[o,i]=l.useState([]),[c,N]=l.useState(""),[s,m]=l.useState(null),[g,x]=l.useState(!0),[b,h]=l.useState(null);l.useEffect(()=>{try{const t=S(j,"ads_client"),r=U(t,u=>{const f=u.docs.map(a=>{const p=a.ref.path.split("/");if(p.length<3||p[0]!=="client_web")return null;const v=p[1];return{id:a.id,userId:v,...a.data(),companyName:a.data().companyName||"No company name",address:a.data().address||"No address provided",adFileUrl:a.data().adFileUrl||"",createdAt:a.data().createdAt||null,expiryDate:a.data().expiryDate||null,done:a.data().done||!1}}).filter(a=>a!==null);d(f),i(f),x(!1)},u=>{h(u.message),x(!1)});return()=>r()}catch(t){h(t.message),x(!1)}},[]),l.useEffect(()=>{const t=n.filter(r=>r.companyName.toLowerCase().includes(c.toLowerCase()));i(t)},[c,n]);const w=t=>{m(t)},A=()=>{m(null)},k=async()=>{if(s)try{const t=C(j,`client_web/${s.userId}/ads_client`,s.id);await L(t,{done:!0,updatedAt:new Date}),d(n.map(r=>r.id===s.id?{...r,done:!0}:r)),i(o.map(r=>r.id===s.id?{...r,done:!0}:r)),m(null)}catch(t){console.error("Error marking as done:",t),h("Failed to update document. It may have been deleted.")}};return g?e.jsx("div",{className:"text-center p-8",children:"Loading ads..."}):b?e.jsxs("div",{className:"text-center p-8 text-red-500",children:["Error: ",b]}):e.jsxs("div",{className:"bg-gray-100 min-h-screen p-5",children:[e.jsx("header",{className:"flex justify-center items-center bg-gray-900 text-white p-5 rounded-lg shadow-md",children:e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Admin Advertisement Review"})}),e.jsx("div",{className:"max-w-3xl mx-auto bg-white p-6 rounded-lg shadow-md mt-6 border border-gray-300",children:s?e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-semibold text-black mb-4",children:"Ad Details"}),e.jsxs("p",{className:"text-lg text-black",children:[e.jsx("strong",{children:"Company Name:"})," ",s.companyName]}),e.jsxs("p",{className:"text-lg text-black",children:[e.jsx("strong",{children:"Address:"})," ",s.address]}),e.jsxs("p",{className:"text-lg text-black",children:[e.jsx("strong",{children:"Schedule Date:"})," ",y(s.createdAt)]}),e.jsxs("p",{className:"text-lg text-black",children:[e.jsx("strong",{children:"Expiry Date:"})," ",y(s.expiryDate)]}),e.jsxs("p",{className:"text-lg text-black",children:[e.jsx("strong",{children:"Video URL:"}),s.adFileUrl?e.jsx("a",{href:s.adFileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"View the URL"}):"No URL provided"]}),s.adFileUrl&&e.jsx("a",{href:s.adFileUrl,download:!0,target:"_blank",rel:"noopener noreferrer",className:"mt-4 inline-block w-full text-center bg-green-600 text-white p-3 rounded hover:bg-green-700 transition font-semibold",children:"Download Video"}),!s.done&&e.jsx("button",{className:"mt-3 w-full bg-indigo-600 text-white p-3 rounded hover:bg-indigo-700 transition font-semibold",onClick:k,children:"Mark as Done"}),e.jsx("button",{className:"mt-3 w-full bg-red-500 text-white p-3 rounded hover:bg-red-600 transition font-semibold",onClick:A,children:"Back"})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-semibold text-black mb-4",children:"Uploaded Ads by Client"}),e.jsx("input",{type:"text",placeholder:"Search by company name...",value:c,onChange:t=>N(t.target.value),className:"w-full p-3 mb-4 border border-gray-400 rounded text-black"}),o.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:g?"Loading...":"No ads found"}):e.jsx("ul",{className:"space-y-4",children:o.map(t=>e.jsxs("li",{className:"p-4 bg-gray-100 rounded-lg shadow-md flex justify-between items-center cursor-pointer hover:bg-gray-200 transition",onClick:()=>w(t),children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-black",children:t.companyName}),e.jsxs("span",{className:"text-gray-600 text-sm",children:["Address: ",t.address]})]}),t.done?e.jsx("span",{className:"bg-green-600 px-2 py-1 text-white rounded text-xs font-semibold ml-2",children:"Done"}):e.jsx("span",{className:"bg-blue-500 px-3 py-1 text-white rounded text-sm font-semibold",children:"View"})]},`${t.userId}-${t.id}`))})]})})]})},V=D(E);export{V as default};
